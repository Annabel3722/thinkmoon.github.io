<!doctype html>
<html data-n-head-ssr lang="zh-CN" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22zh-CN%22%7D%7D">
<head>
  <title>Ubuntu深度学习的相关配置</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta data-n-head="ssr" data-hid="keywords" name="keywords" content="thinkmoon,醉月思,指尖魔法屋"><meta data-n-head="ssr" data-hid="description" name="description" content="总结与记录是两个极其优秀的学习习惯！"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="/highlight/atom-one-dark.min.css"><link data-n-head="ssr" rel="stylesheet" href="/style.css"><script data-n-head="ssr" src="/highlight/highlight.min.js"></script><link rel="preload" href="/_nuxt/e4b7d96.js" as="script"><link rel="preload" href="/_nuxt/fc6b942.js" as="script"><link rel="preload" href="/_nuxt/css/edb8de7.css" as="style"><link rel="preload" href="/_nuxt/623b5d2.js" as="script"><link rel="preload" href="/_nuxt/746647a.js" as="script"><link rel="stylesheet" href="/_nuxt/css/edb8de7.css"><link rel="preload" href="/_nuxt/static/1620746793/post/638/state.js" as="script"><link rel="preload" href="/_nuxt/static/1620746793/post/638/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1620746793/manifest.js" as="script">
</head>
<body>
<div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div class="container"><div class="article-content"><h1 class="article-title">
      Ubuntu深度学习的相关配置
    </h1> <div><p><img src="https://blog.cdn.thinkmoon.cn/blog/typecho/2019-12-19T14:19:05.png" alt="tensorflow"></p>
<h2 id="安装nvidia驱动">安装NVIDIA驱动</h2>
<ol>
<li><p>查看显卡信息</p>
<pre><code class="language-shell">ubuntu-drivers devices
</code></pre>
</li>
<li><p>自动安装显卡驱动</p>
</li>
</ol>
<pre><code class="language-shell">sudo ubuntu-drivers autoinstall
</code></pre>
<ol start="3">
<li>确认是否安装成功<pre><code class="language-shell">nvidia-smi
</code></pre>
</li>
</ol>
<h2 id="安装docker">安装docker</h2>
<p><a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">安装文档</a></p>
<p>使用阿里源安装</p>
<pre><code class="language-shell"># step 1: 安装必要的一些系统工具
sudo apt-get update
sudo apt-get -y install apt-transport-https ca-certificates curl software-properties-common
# step 2: 安装GPG证书
curl -fsSL http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
# Step 3: 写入软件源信息
sudo add-apt-repository "deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable"
# Step 4: 更新并安装Docker-CE
sudo apt-get -y update
sudo apt-get -y install docker-ce

# 安装指定版本的Docker-CE:
# Step 1: 查找Docker-CE的版本:
# apt-cache madison docker-ce
#   docker-ce | 17.03.1~ce-0~ubuntu-xenial | http://mirrors.aliyun.com/docker-ce/linux/ubuntu xenial/stable amd64 Packages
#   docker-ce | 17.03.0~ce-0~ubuntu-xenial | http://mirrors.aliyun.com/docker-ce/linux/ubuntu xenial/stable amd64 Packages
# Step 2: 安装指定版本的Docker-CE: (VERSION例如上面的17.03.1~ce-0~ubuntu-xenial)
# sudo apt-get -y install docker-ce=[VERSION]
</code></pre>
<blockquote>
<p>tips: 由于使用的是19.10版本，暂时没有对应的源，故手动将step 3切换至19.04 </p>
</blockquote>
<pre><code class="language-bash">sudo add-apt-repository "deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu disco stable"
</code></pre>
<h2 id="安装nvidia-container-toolkit">安装NVIDIA Container Toolkit</h2>
<h3 id="add-the-package-repositories">Add the package repositories</h3>
<pre><code class="language-shell">distribution=$(. /etc/os-release;echo $ID$VERSION_ID)
curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -
curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list
sudo apt-get update && sudo apt-get install -y nvidia-container-toolkit
sudo systemctl restart docker
</code></pre>
<h2 id="测试">测试</h2>
<pre><code class="language-bash">sudo docker run --gpus all -it --rm tensorflow/tensorflow:latest-gpu-py3    python -c "import tensorflow as tf; print(tf.reduce_sum(tf.random.normal([1000, 1000])))"
</code></pre>
<h2 id="装载工作目录至容器">装载工作目录至容器</h2>
<pre><code class="language-bash">docker run --gpus all -itd --name tf --rm -v $PWD:/tmp -w /tmp tensorflow/tensorflow:latest-gpu-py3
</code></pre>
<p>以上命令在后台创建了一个支持GPU的tensorflow:latest-gpu-py3容器，将其命名为tf（方便后面容器操作），并将工作目录切换至主机当前目录。</p>
<p><img src="https://blog.cdn.thinkmoon.cn/blog/typecho/2019-12-20T13:55:02.png" alt="装载工作目录至tensorflow容器"></p>
<h2 id="参考资料">参考资料</h2>
<p><a href="https://blog.csdn.net/yy2yy99/article/details/88569589">Ubuntu 18.04 安装NVIDIA驱动 实践</a><br><a href="https://www.tensorflow.org/">tensorflow官网</a></p>
</div></div></div></div></div></div><script defer src="/_nuxt/static/1620746793/post/638/state.js"></script><script src="/_nuxt/e4b7d96.js" defer></script><script src="/_nuxt/fc6b942.js" defer></script><script src="/_nuxt/623b5d2.js" defer></script><script src="/_nuxt/746647a.js" defer></script>
</body>
<script defer>hljs.highlightAll()</script>
</html>
