__NUXT_JSONP__("/post/530", {data:[{article:"\u003C!--markdown--\u003E\u003E 平常我们有些写各种网站, 个人博客系统, 物流管理系统, 通信录管理系统, 校园二手网站. 我们都知道, 只需要租用一个服务器, 再配置一个备案好的域名, 就可以在浏览器上进行访问了.\n\u003Cblockquote\u003E\n\u003Cp\u003E不知大家, 不知大家有没有想过, 将你搭的网站对接微信公众号, 利用微信这个大用户软件, 来为你引流呢? \u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003C!-- more --\u003E\n\u003Chr\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth\u003E本文环境\u003C\u002Fth\u003E\n\u003Cth\u003E版本\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Fthead\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\n\u003Ctd\u003E操作系统\u003C\u002Ftd\u003E\n\u003Ctd\u003EUbuntu 16.04.03\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E运行方式\u003C\u002Ftd\u003E\n\u003Ctd\u003EVMware虚拟机\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E编程语言\u003C\u002Ftd\u003E\n\u003Ctd\u003EPHP\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E项目局域网地址\u003C\u002Ftd\u003E\n\u003Ctd\u003E\u003Ca href=\"http:\u002F\u002F192.168.253.1\u002Faudit\"\u003Ehttp:\u002F\u002F192.168.253.1\u002Faudit\u003C\u002Fa\u003E\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\n\u003Chr\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523606408034.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E Q: 你在搞笑吗? 不是直接在微信里面打开的吗?\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EA: 直接用微信打开是可以, 然后你在微信里面让用户再注册一个账号? 对于大部分不想麻烦的小伙伴来说, 他们会对此忘而却步. 其实微信是提供接口, 让你可以获取到微信的用户名,和用户头像的. \u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch2 id=\"一般来说分为三种情况\"\u003E一般来说分为三种情况\u003C\u002Fh2\u003E\n\u003Col\u003E\n\u003Cli\u003E\u003Cp\u003E使用通过的微信\u003Cstrong\u003E开放\u003C\u002Fstrong\u003E平台( 注意,不是微信公众平台) \u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E需要开发者认证\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E使用认证过的订阅号.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E需要微信认证\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E使用认证过的服务号\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E需要微信认证\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch2 id=\"额-那其实不是没认证就没得玩\"\u003E额, 那其实不是没认证就没得玩?\u003C\u002Fh2\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E好吧, 实际是的确如此, 不过. 如果你真的只是想玩玩. 你可以去这儿. \u003Ca href=\"https:\u002F\u002Fmp.weixin.qq.com\u002Fdebug\u002Fcgi-bin\u002Fsandbox?t=sandbox\u002Flogin\"\u003Ehttps:\u002F\u002Fmp.weixin.qq.com\u002Fdebug\u002Fcgi-bin\u002Fsandbox?t=sandbox\u002Flogin\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523712185351.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E微信测试号\u003C\u002Fp\u003E\n\u003Ch3 id=\"优点\"\u003E优点\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E 拥有几乎所有接口, \u003C\u002Fli\u003E\n\u003Cli\u003E 以及享受局域网IP回调(意思就是说,可以支持局域网, 这是正式微信平台号所不具备的)\u003C\u002Fli\u003E\n\u003Cli\u003E发送模板消息, 不用审核.\u003Ch3 id=\"缺点\"\u003E缺点\u003C\u002Fh3\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E只支持最多100个用户\u003C\u002Fli\u003E\n\u003Cli\u003E不能设置名称, 头像.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E对于一些只是想玩玩, 或者小规模用户的是没有问题的.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch3 id=\"跟我一起操作\"\u003E跟我一起操作\u003C\u002Fh3\u003E\n\u003Ch4 id=\"登录\"\u003E登录\u003C\u002Fh4\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E扫码登录就好了;\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch4 id=\"微信token\"\u003E微信token\u003C\u002Fh4\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E新建php文件(啥语言都可以,自行修改)\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-php\"\u003Epublic function token()\n    {\n        $nonce = $_GET[&#39;nonce&#39;];\n        $token = &#39;weixin&#39;;\n        $timestamp = $_GET[&#39;timestamp&#39;];\n        $echostr = $_GET[&#39;echostr&#39;];\n        $signature = $_GET[&#39;signature&#39;];\n        \u002F\u002F形成数组，然后按字典序排序\n        $array = array();\n        $array = array($nonce, $timestamp, $token);\n        sort($array);\n        \u002F\u002F拼接成字符串,sha1加密 ，然后与signature进行校验\n        $str = sha1(implode($array));\n        if ($str == $signature &amp;&amp; $echostr) {\n            \u002F\u002F第一次接入weixin api接口的时候\n            echo $echostr;\n            exit;\n        }\n    }\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E然后在测试号里填写路径和token, 认证成功后就可以继续操作了\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523713636476.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003ETIP: 这个链接并不需要一直可访问,\u003Cstrong\u003E只需要第一次认证通过就OK\u003C\u002Fstrong\u003E, 甚至认证过可以直接删掉.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch3 id=\"修改回调域名-接口-网页授权获取用户基本信息--修改\"\u003E修改回调域名, 接口&gt; 网页授权获取用户基本信息 &gt; 修改\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523781481068.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E\u003Cstrong\u003E只有测试号支持ip\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch3 id=\"微信的接口\"\u003E微信的接口\u003C\u002Fh3\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E接口详情可在\u003Cem\u003E\u003Ca href=\"https:\u002F\u002Fmp.weixin.qq.com\u002Fwiki?t=resource\u002Fres_main&amp;id=mp1421141013\"\u003Ehttps:\u002F\u002Fmp.weixin.qq.com\u002Fwiki?t=resource\u002Fres_main&amp;id=mp1421141013\u003C\u002Fa\u003E\u003C\u002Fem\u003E里查看\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E\u003Cstrong\u003E注意\u003C\u002Fstrong\u003E: \u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003E这些接口不是简单的对接就好了, 每次请求都需要携带access_token,\u003C\u002Fli\u003E\n\u003Cli\u003E 而获取access_token, 每天有获取上限.\u003C\u002Fli\u003E\n\u003Cli\u003Eaccess-token具有有效期(7200s) , 过期需要重新获取. \u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E获取access_token的方法\u003Cem\u003E\u003Ca href=\"https:\u002F\u002Fmp.weixin.qq.com\u002Fdebug\u002Fcgi-bin\u002Fapiinfo?t=index&amp;type=%E5%9F%BA%E7%A1%80%E6%94%AF%E6%8C%81&amp;form=%E8%8E%B7%E5%8F%96access_token%E6%8E%A5%E5%8F%A3%20\u002Ftoken\"\u003Ehttps:\u002F\u002Fmp.weixin.qq.com\u002Fdebug\u002Fcgi-bin\u002Fapiinfo?t=index&amp;type=%E5%9F%BA%E7%A1%80%E6%94%AF%E6%8C%81&amp;form=%E8%8E%B7%E5%8F%96access_token%E6%8E%A5%E5%8F%A3%20\u002Ftoken\u003C\u002Fa\u003E\u003C\u002Fem\u003E\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch3 id=\"获取用户信息-实现免登录的效果\"\u003E获取用户信息, 实现免登录的效果\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523714004736.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E在这儿我们需要三个接口\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch4 id=\"所用接口\"\u003E所用接口:\u003C\u002Fh4\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E接口一: \n\u003Cem\u003E\u003Ccode\u003Ehttps:\u002F\u002Fopen.weixin.qq.com\u002Fconnect\u002Foauth2\u002Fauthorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirect\u003C\u002Fcode\u003E\u003C\u002Fem\u003E\n接口二:\n\u003Cem\u003E\u003Ccode\u003Ehttps:\u002F\u002Fapi.weixin.qq.com\u002Fsns\u002Foauth2\u002Faccess_token?appid=APPID&amp;secret=SECRET&amp;code=CODE&amp;grant_type=authorization_code\u003C\u002Fcode\u003E\u003C\u002Fem\u003E\n接口三:\n\u003Cem\u003E\u003Ccode\u003Ehttps:\u002F\u002Fapi.weixin.qq.com\u002Fsns\u002Fuserinfo?access_token=ACCESS_TOKEN&amp;openid=OPENID&amp;lang=zh_CN\u003C\u002Fcode\u003E\u003C\u002Fem\u003E\n接口四: 刷新access_token\n\u003Cem\u003E\u003Ccode\u003Ehttps:\u002F\u002Fapi.weixin.qq.com\u002Fsns\u002Foauth2\u002Frefresh_token?appid=APPID&amp;grant_type=refresh_token&amp;refresh_token=REFRESH_TOKEN\u003C\u002Fcode\u003E\u003C\u002Fem\u003E\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E接口返回数据, 详见\u003Cem\u003E\u003Ca href=\"https:\u002F\u002Fmp.weixin.qq.com\u002Fwiki?t=resource\u002Fres_main&amp;id=mp1421140842\"\u003Ehttps:\u002F\u002Fmp.weixin.qq.com\u002Fwiki?t=resource\u002Fres_main&amp;id=mp1421140842\u003C\u002Fa\u003E\u003C\u002Fem\u003E\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Col\u003E\n\u003Cli\u003E\u003Cp\u003E第一步：用户同意授权，获取code\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E示例:( 注意appid, redirect_url是变量)\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-php\"\u003E$str = &#39;http:\u002F\u002Fopen.weixin.qq.com\u002Fconnect\u002Foauth2\u002Fauthorize?appid=wx20874ebf2ea1fc7f&amp;redirect_uri=&#39; . urlencode(&quot;http:\u002F\u002F192.168.253.1\u002Faudit\u002Fclient\u002F&quot;) . &#39;&amp;response_type=code&amp;scope=snsapi_base&amp;state=123#wechat_redirect&#39;;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523714822433.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E第二步：通过code换取网页授权access_token\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E示例\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-php\"\u003E$data = json_decode(file_get_contents(&quot;https:\u002F\u002Fapi.weixin.qq.com\u002Fsns\u002Foauth2\u002Faccess_token?appid=&quot; . $this-&gt;appid . &quot;&amp;secret=&quot; . $this-&gt;secret . &quot;&amp;code=&quot; . $_GET[&#39;code&#39;] . &quot;&amp;grant_type=authorization_code&quot;));\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E\u003Cstrong\u003E注意\u003C\u002Fstrong\u003E: 此处的access_token与上面的access_token不是同一个东西\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E第三步: 通过access_token换取userinfo\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E示例\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-php\"\u003E$userInfo = json_decode(file_get_contents(&quot;https:\u002F\u002Fapi.weixin.qq.com\u002Fsns\u002Fuserinfo?access_token=&quot; . $data-&gt;access_token . &quot;&amp;openid=&quot; . $data-&gt;openid . &quot;&amp;lang=zh_CN&quot;));\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E刷新access_token, 如果需要\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E这是我画的一个请求过程图, 可以帮助理解\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-%E6%9C%AA%E5%91%BD%E5%90%8D%E6%96%87%E4%BB%B6%20%281%29.svg\" alt=\"enter description here\" title=\"未命名文件 &#40;1&#41;\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"测试演示\"\u003E测试演示\u003C\u002Fh3\u003E\n\u003Ch4 id=\"1-将授权url发给手机\"\u003E1. 将授权url发给手机\u003C\u002Fh4\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E非必需, 也可以在电脑上, 也可以写到公众号子菜单中点击进入. \u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch4 id=\"2-关注测试号\"\u003E2. 关注测试号\u003C\u002Fh4\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E不然会这样\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523781959421.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n\u003Ch4 id=\"关注后点击\"\u003E关注后点击\u003C\u002Fh4\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523782005232.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523782015976.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n\u003Ch4 id=\"测试号访问成功\"\u003E测试号访问成功.\u003C\u002Fh4\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E额, 关于后台代码原理就不讲了. \n类似于一个从微信服务器发来的表单, 登录进了系统, 然后再把这些数据存入数据库就好了.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch3 id=\"正式号运行效果\"\u003E正式号运行效果\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523890856126.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fblog.cdn.thinkmoon.cn\u002F%E5%B0%8F%E4%B9%A6%E5%8C%A0\u002F2018-4-1523890881266.jpg\" alt=\"enter description here\"\u003E\u003C\u002Fp\u003E\n"}],fetch:{},mutations:void 0});